app.controller("addCourseCtrl",["$scope","$http","httpService","$uibModalInstance","SweetAlert","$rootScope",function(t,e,o,n,a,c){t.cancel=function(){n.dismiss("cancel")},t.title="添加课程信息",t.type=0,t.disabled=!0,t.teacherInfo=[],t.majorInfo=[],t.school_id="",t.teacher_id="",t.element_id="",t.getTeacherAndMajor=function(){o.getAll(null,"course/getAllTeacherAndMajor").then(function(e){t.re=e,t.schoolInfo=e[2]},function(){console.log("获取教师(开课单位)失败")})},t.getTeacherAndMajor(),t.change=function(){t.majorInfo=[],t.teacherInfo=[];try{if(null!=t.school_id)for(var e in t.re[1])t.school_id==t.re[1][e].school_id&&t.majorInfo.push(t.re[1][e])}catch(e){console.log("e",e)}},t.changeCollege=function(){t.teacherInfo=[];try{if(null!=t.element_id)for(var e in t.re[0])t.element_id==t.re[0][e].college_id&&t.teacherInfo.push(t.re[0][e]);console.log(1,t.teacherInfo)}catch(e){console.log("e",e)}},t.submitForm=function(){if(console.log(123),t.submit_form.$valid){var e={code:t.code,name:t.name,class_hour:t.class_hour,type:t.type,teacher_id:t.teacher_id,major_id:t.element_id,school_id:t.school_id,class_time:t.class_time,start_time:t.start_time,end_time:t.end_time};console.log("op",e),o.addRow(e,"course/addCourse").then(function(e){t.result=e,t.cancel(),a.swal("操作成功","","success")},function(){a.swal("操作失败","","error")})}else a.swal("操作失败","","error")}}]),app.controller("courseManageCtrl",["$http","httpService","$scope","$uibModal","SweetAlert","$rootScope",function(e,o,n,t,a,c){n.root={},n.rowlist=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.changePageSize=function(e){n.pagination.pageSize=e,n.pagination.currentPage=1,n.queryList()},n.queryList=function(){var e={code:n.code,name:n.name,pageNo:n.pagination.currentPage,pageSize:n.pagination.pageSize};o.getAll(e,"course/showCourse").then(function(e){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data},function(){})},n.queryList(),n.addCourse=function(){t.open({size:"lg",backdrop:"static",keyboard:!1,animation:!0,templateUrl:"courseForm.html",controller:"addCourseCtrl"}).result.then(function(e){},function(e){n.queryList()})},n.editRow=function(e){t.open({size:"lg",backdrop:"static",keyboard:!1,animation:!0,templateUrl:"courseForm.html",controller:"updateCourseCtrl",resolve:{data:n.root.data[e]}}).result.then(function(e){},function(e){n.queryList()})},n.reset=function(){n.name=null,n.code=null,n.queryList()},n.delRow=function(e){var t={id:e};a.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&o.delRow(t,"course/delCourse").then(function(e){n.result=e,n.queryList(),1==e?a.swal("删除成功","","success"):a.swal("删除失败","","error")},function(){a.swal("删除失败","","error")})})},n.checked=[],n.selectAll=function(){n.select_all?(n.checked=[],angular.forEach(n.root.data,function(e){e.checked=!0,n.checked.push(e.id)})):angular.forEach(n.root.data,function(e){e.checked=!1,n.checked=[]})},n.selectOne=function(){angular.forEach(n.root.data,function(e){var t=n.checked.indexOf(e.id);e.checked&&-1===t?n.checked.push(e.id):e.checked||-1===t||n.checked.splice(t,1)}),n.root.data.length===n.checked.length?n.select_all=!0:n.select_all=!1},n.delRows=function(){if(n.checked.length<0||0===n.checked.length)a.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:n.checked};a.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&o.delRows(t,"course/delCourses").then(function(e){n.result=e,n.queryList(),1==e?a.swal("删除成功","","success"):a.swal("删除失败","","error")},function(){a.swal("删除失败","","error")})})}}}]),app.controller("updateCourseCtrl",["$scope","data","$uibModalInstance","SweetAlert","httpService",function(o,t,e,n,a){console.log("da",t),o.title="编辑课程信息",o.code=t.code?t.code:"",o.name=t.name?t.name:"",o.class_hour=t.class_hour?t.class_hour:"",o.type=t.type?t.type:"",o.start_time=t.start_time?t.start_time:"",o.end_time=t.end_time?t.end_time:"",o.class_time=t.class_time?t.class_time:"",o.cancel=function(){e.dismiss("cancel")};try{o.school_id=t.school_id?t.school_id:"",o.teacher_id=t.teacher_id?t.teacher_id:"",o.element_id=t.college_id?t.college_id:""}catch(e){}o.getTeacherAndMajor=function(){o.majorInfo=[],o.teacherInfo=[],a.getAll(null,"course/getAllTeacherAndMajor").then(function(e){if(o.re=e,o.schoolInfo=e[2],null!=o.school_id)for(var t in o.re[1])o.school_id==o.re[1][t].school_id&&o.majorInfo.push(o.re[1][t]);if(null!=o.element_id)for(var t in o.re[0])o.element_id==o.re[0][t].college_id&&o.teacherInfo.push(o.re[0][t])},function(){console.log("获取教师(开课单位)失败")})},o.getTeacherAndMajor(),o.change=function(){o.majorInfo=[],o.teacherInfo=[];try{if(null!=o.school_id)for(var e in o.re[1])o.school_id==o.re[1][e].school_id&&o.majorInfo.push(o.re[1][e])}catch(e){console.log("e",e)}},o.changeCollege=function(){o.teacherInfo=[];try{if(null!=o.element_id)for(var e in o.re[0])o.element_id==o.re[0][e].college_id&&o.teacherInfo.push(o.re[0][e]);console.log(1,o.teacherInfo)}catch(e){console.log("e",e)}},o.submitForm=function(){if(o.submit_form.$valid){var e={id:t.id,code:o.code,name:o.name,class_hour:o.class_hour,type:o.type,teacher_id:o.teacher_id,major_id:o.element_id,school_id:o.school_id,class_time:o.class_time,start_time:o.start_time,end_time:o.end_time};console.log("params:",e),a.updateRow(e,"course/updateCourse").then(function(e){o.result=e,o.cancel(),1==e?n.swal("修改成功","","success"):n.swal("修改失败","","error")},function(){n.swal("修改失败","","error")})}else n.swal("修改失败","","error")}}]),app.controller("indexController",["$scope","$rootScope","$http","httpService","localStorageService","$interval","SweetAlert","$window","baseService",function(e,t,o,n,a,c,l,r,i){}]),app.controller("adduserModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(t,e,o,n,a,c,l,r,i,s,u){t.title="添加用户",t.Marks=[{id:1,name:"学生"},{id:2,name:"教师"}],t.mark=1,t.cancel=function(){l.dismiss("cancel")},t.reader=new FileReader,t.img_upload=function(e){t.reader.readAsDataURL(e[0]),t.reader.onload=function(e){t.$apply(function(){t.path=e.target.result})}},t.submitForm=function(){if(t.submit_form.$valid){var e={username:t.username,mark:t.mark};r.addRow(e,"user/addUser").then(function(e){u.upload({url:"/web-logistics/user/uploadImage",data:{id:e.id},file:t.file}),l.dismiss("ok"),i.swal("操作成功","","success")},function(){})}}}]),app.controller("UserInfoController",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,n,a,c,l,r,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.queryList=function(){var e={username:o.username,pageNo:o.pagination.currentPage,pageSize:o.pagination.pageSize};l.getAll(e,"user/showUser").then(function(e){o.pagination.totalCount=e.totalCount,o.pagination.totalPage=e.totalPage,o.pagination.pageSize=e.pageSize,o.pagination.currentPage=e.pageNo,o.root.data=e.data},function(){})},o.queryList(),o.reset=function(){o.username="",o.queryList()},o.addUserInfo=function(){c.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"userForm.html",controller:"adduserModalCtrl"}).result.then(function(e){},function(e){o.reset()})},o.delRow=function(e){var t={id:e};r.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRow(t,"user/delUser").then(function(e){1==e?(o.reset(),r.swal("操作成功","","success")):r.swal("操作失败","","error")},function(){r.swal("操作失败","","error")})})},o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root.data,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root.data,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root.data,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.data.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.delRows=function(){if(o.checked.length<0||0===o.checked.length)r.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:o.checked};r.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRows(t,"user/delUsers").then(function(e){e?(o.reset(),o.select_all=!1,r.swal("操作成功","","success")):r.swal("操作失败","","error")})})}}}]),app.controller("addschoolModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(t,e,o,n,a,c,l,r,i,s,u){t.title="添加学校",t.cancel=function(){l.dismiss("cancel")},t.submitForm=function(){if(t.submit_form.$valid){var e={school_code:t.school_code,school_name:t.school_name,school_detail:t.school_detail};r.addRow(e,"school/addSchool").then(function(e){e&&null!=e?(l.dismiss("ok"),i.swal("操作成功","","success")):i.swal("操作成功","","error")},function(){i.swal("操作成功","","error")})}}}]),app.controller("collegeManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(e,t,o,n,a,c,l,r,i,s){}]),app.controller("majorManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(e,t,o,n,a,c,l,r,i,s){}]),app.controller("schoolManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,n,a,c,l,r,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.queryList=function(){var e={school_code:o.school_code,school_name:o.school_name,pageNo:o.pagination.currentPage,pageSize:o.pagination.pageSize};l.getAll(e,"school/showSchool").then(function(e){o.pagination.totalCount=e.totalCount,o.pagination.totalPage=e.totalPage,o.pagination.pageSize=e.pageSize,o.pagination.currentPage=e.pageNo,o.root.data=e.data},function(){})},o.queryList(),o.reset=function(){o.school_code="",o.school_name="",o.queryList()},o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root.data,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root.data,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root.data,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.data.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.delRow=function(e){var t={id:e};r.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRow(t,"school/delSchool").then(function(e){1==e?(o.reset(),r.swal("操作成功","","success")):r.swal("操作失败","","error")},function(){r.swal("操作失败","","error")})})},o.delRows=function(){if(o.checked.length<0||0===o.checked.length)r.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:o.checked};r.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRows(t,"school/delSchools").then(function(e){e?(o.reset(),o.select_all=!1,r.swal("操作成功","","success")):r.swal("操作失败","","error")})})}},o.addSchool=function(){c.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"schoolForm.html",controller:"addschoolModalCtrl"}).result.then(function(e){},function(e){o.reset()})}}]);