app.controller("addCourseCtrl",["$scope","$http","httpService","$uibModalInstance","SweetAlert","$rootScope",function(t,e,o,a,n,r){t.cancel=function(){a.dismiss("cancel")},t.title="添加课程信息",t.type=0,t.disabled=!0,t.teacherInfo=[],t.majorInfo=[],t.school_id="",t.teacher_id="",t.element_id="",t.getTeacherAndMajor=function(){o.getAll(null,"course/getAllTeacherAndMajor").then(function(e){t.re=e,t.schoolInfo=e[2]},function(){console.log("获取教师(开课单位)失败")})},t.getTeacherAndMajor(),t.change=function(){t.majorInfo=[],t.teacherInfo=[];try{if(null!=t.school_id)for(var e in t.re[1])t.school_id==t.re[1][e].school_id&&t.majorInfo.push(t.re[1][e])}catch(e){console.log("e",e)}},t.changeCollege=function(){t.teacherInfo=[];try{if(null!=t.element_id)for(var e in t.re[0])t.element_id==t.re[0][e].college_id&&t.teacherInfo.push(t.re[0][e]);console.log(1,t.teacherInfo)}catch(e){console.log("e",e)}},t.submitForm=function(){if(console.log(123),t.submit_form.$valid){var e={code:t.code,name:t.name,class_hour:t.class_hour,type:t.type,teacher_id:t.teacher_id,major_id:t.element_id,school_id:t.school_id,class_time:t.class_time,start_time:t.start_time,end_time:t.end_time};console.log("op",e),o.addRow(e,"course/addCourse").then(function(e){t.result=e,t.cancel(),n.swal("操作成功","","success")},function(){n.swal("操作失败","","error")})}else n.swal("操作失败","","error")}}]),app.controller("courseManageCtrl",["$http","httpService","$scope","$uibModal","SweetAlert","$rootScope",function(e,o,a,t,n,r){a.root={},a.rowlist=[],a.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},a.changePageSize=function(e){a.pagination.pageSize=e,a.pagination.currentPage=1,a.queryList()},a.queryList=function(){var e={code:a.code,name:a.name,pageNo:a.pagination.currentPage,pageSize:a.pagination.pageSize};o.getAll(e,"course/showCourse").then(function(e){a.pagination.totalCount=e.totalCount,a.pagination.totalPage=e.totalPage,a.pagination.pageSize=e.pageSize,a.pagination.currentPage=e.pageNo,a.root.data=e.data},function(){})},a.queryList(),a.addCourse=function(){t.open({size:"lg",backdrop:"static",keyboard:!1,animation:!0,templateUrl:"courseForm.html",controller:"addCourseCtrl"}).result.then(function(e){},function(e){a.queryList()})},a.editRow=function(e){t.open({size:"lg",backdrop:"static",keyboard:!1,animation:!0,templateUrl:"courseForm.html",controller:"updateCourseCtrl",resolve:{data:a.root.data[e]}}).result.then(function(e){},function(e){a.queryList()})},a.reset=function(){a.name=null,a.code=null,a.queryList()},a.delRow=function(e){var t={id:e};n.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&o.delRow(t,"course/delCourse").then(function(e){a.result=e,a.queryList(),1==e?n.swal("删除成功","","success"):n.swal("删除失败","","error")},function(){n.swal("删除失败","","error")})})},a.checked=[],a.selectAll=function(){a.select_all?(a.checked=[],angular.forEach(a.root.data,function(e){e.checked=!0,a.checked.push(e.id)})):angular.forEach(a.root.data,function(e){e.checked=!1,a.checked=[]})},a.selectOne=function(){angular.forEach(a.root.data,function(e){var t=a.checked.indexOf(e.id);e.checked&&-1===t?a.checked.push(e.id):e.checked||-1===t||a.checked.splice(t,1)}),a.root.data.length===a.checked.length?a.select_all=!0:a.select_all=!1},a.delRows=function(){if(a.checked.length<0||0===a.checked.length)n.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:a.checked};n.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&o.delRows(t,"course/delCourses").then(function(e){a.result=e,a.queryList(),1==e?n.swal("删除成功","","success"):n.swal("删除失败","","error")},function(){n.swal("删除失败","","error")})})}}}]),app.controller("updateCourseCtrl",["$scope","data","$uibModalInstance","SweetAlert","httpService",function(o,t,e,a,n){console.log("da",t),o.title="编辑课程信息",o.code=t.code?t.code:"",o.name=t.name?t.name:"",o.class_hour=t.class_hour?t.class_hour:"",o.type=t.type?t.type:"",o.start_time=t.start_time?t.start_time:"",o.end_time=t.end_time?t.end_time:"",o.class_time=t.class_time?t.class_time:"",o.cancel=function(){e.dismiss("cancel")};try{o.school_id=t.school_id?t.school_id:"",o.teacher_id=t.teacher_id?t.teacher_id:"",o.element_id=t.college_id?t.college_id:""}catch(e){}o.getTeacherAndMajor=function(){o.majorInfo=[],o.teacherInfo=[],n.getAll(null,"course/getAllTeacherAndMajor").then(function(e){if(o.re=e,o.schoolInfo=e[2],null!=o.school_id)for(var t in o.re[1])o.school_id==o.re[1][t].school_id&&o.majorInfo.push(o.re[1][t]);if(null!=o.element_id)for(var t in o.re[0])o.element_id==o.re[0][t].college_id&&o.teacherInfo.push(o.re[0][t])},function(){console.log("获取教师(开课单位)失败")})},o.getTeacherAndMajor(),o.change=function(){o.majorInfo=[],o.teacherInfo=[];try{if(null!=o.school_id)for(var e in o.re[1])o.school_id==o.re[1][e].school_id&&o.majorInfo.push(o.re[1][e])}catch(e){console.log("e",e)}},o.changeCollege=function(){o.teacherInfo=[];try{if(null!=o.element_id)for(var e in o.re[0])o.element_id==o.re[0][e].college_id&&o.teacherInfo.push(o.re[0][e]);console.log(1,o.teacherInfo)}catch(e){console.log("e",e)}},o.submitForm=function(){if(o.submit_form.$valid){var e={id:t.id,code:o.code,name:o.name,class_hour:o.class_hour,type:o.type,teacher_id:o.teacher_id,major_id:o.element_id,school_id:o.school_id,class_time:o.class_time,start_time:o.start_time,end_time:o.end_time};console.log("params:",e),n.updateRow(e,"course/updateCourse").then(function(e){o.result=e,o.cancel(),1==e?a.swal("修改成功","","success"):a.swal("修改失败","","error")},function(){a.swal("修改失败","","error")})}else a.swal("修改失败","","error")}}]),app.controller("accountManageCtrl",["$scope","localStorageService",function(e,t){console.log(11,t.get("userInfo"))}]),app.controller("addcollegeModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(n,e,t,o,a,r,l,c,i,s,u){n.title="添加学院",n.cancel=function(){l.dismiss("cancel")},n.schools=[],n.college_code="",n.college_name="",n.college_detail="",n.submitForm=function(){if(n.submit_form.$valid){var e={college_code:n.college_code,college_name:n.college_name,college_detail:n.college_detail,school_id:n.school_id};c.addRow(e,"college/addCollege").then(function(e){e&&null!=e?(l.dismiss("ok"),i.swal("操作成功","","success")):i.swal("操作失败","","error")},function(){i.swal("操作失败","","error")})}},n.getAllSchool=function(){e.get("../school/getAllSchoolForSelect").success(function(e,t,o,a){n.schools=e}).error(function(e,t,o,a){})},n.getAllSchool()}]),app.controller("addmajorModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(t,e,o,a,n,r,l,c,i,s,u){t.title="添加专业",t.cancel=function(){l.dismiss("cancel")},t.major_code="",t.major_name="",t.major_detail="",t.submitForm=function(){if(t.submit_form.$valid){var e={major_code:t.major_code,major_name:t.major_name,major_detail:t.major_detail};c.addRow(e,"major/addMajor").then(function(e){e&&null!=e?(l.dismiss("ok"),i.swal("操作成功","","success")):i.swal("操作成功","","error")},function(){i.swal("操作成功","","error")})}}}]),app.controller("addschoolModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(t,e,o,a,n,r,l,c,i,s,u){t.title="添加学校",t.cancel=function(){l.dismiss("cancel")},t.submitForm=function(){if(t.submit_form.$valid){var e={school_code:t.school_code,school_name:t.school_name,school_detail:t.school_detail};c.addRow(e,"school/addSchool").then(function(e){e&&null!=e?(l.dismiss("ok"),i.swal("操作成功","","success")):i.swal("操作成功","","error")},function(){i.swal("操作成功","","error")})}}}]),app.controller("collegeManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,a,n,r,l,c,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.queryList=function(){var e={college_code:o.college_code,college_name:o.college_name,pageNo:o.pagination.currentPage,pageSize:o.pagination.pageSize};l.getAll(e,"college/showCollege").then(function(e){o.pagination.totalCount=e.totalCount,o.pagination.totalPage=e.totalPage,o.pagination.pageSize=e.pageSize,o.pagination.currentPage=e.pageNo,o.root.data=e.data},function(){c.swal("操作失败","","error")})},o.queryList(),o.reset=function(){o.college_code="",o.college_name="",o.queryList()},o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root.data,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root.data,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root.data,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.data.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.delRow=function(e){var t={id:e};c.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRow(t,"college/delCollege").then(function(e){1==e?(o.reset(),c.swal("操作成功","","success")):c.swal("操作失败","","error")},function(){c.swal("操作失败","","error")})})},o.delRows=function(){if(o.checked.length<0||0===o.checked.length)c.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:o.checked};c.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRows(t,"college/delColleges").then(function(e){e?(o.reset(),o.select_all=!1,c.swal("操作成功","","success")):c.swal("操作失败","","error")})})}},o.addCollege=function(){r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"collegeForm.html",controller:"addcollegeModalCtrl"}).result.then(function(e){},function(e){o.reset()})}}]),app.controller("majorManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,a,n,r,l,c,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.queryList=function(){var e={major_code:o.major_code,major_name:o.major_name,pageNo:o.pagination.currentPage,pageSize:o.pagination.pageSize};l.getAll(e,"major/showMajor").then(function(e){o.pagination.totalCount=e.totalCount,o.pagination.totalPage=e.totalPage,o.pagination.pageSize=e.pageSize,o.pagination.currentPage=e.pageNo,o.root.data=e.data},function(){c.swal("操作失败","","error")})},o.queryList(),o.reset=function(){o.major_code="",o.major_name="",o.queryList()},o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root.data,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root.data,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root.data,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.data.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.delRow=function(e){var t={id:e};c.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRow(t,"major/delMajor").then(function(e){1==e?(o.reset(),c.swal("操作成功","","success")):c.swal("操作失败","","error")},function(){c.swal("操作失败","","error")})})},o.delRows=function(){if(o.checked.length<0||0===o.checked.length)c.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:o.checked};c.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRows(t,"major/delMajors").then(function(e){e?(o.reset(),o.select_all=!1,c.swal("操作成功","","success")):c.swal("操作失败","","error")})})}},o.addMajor=function(){r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"majorForm.html",controller:"addmajorModalCtrl"}).result.then(function(e){},function(e){o.reset()})}}]),app.controller("schoolManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,a,n,r,l,c,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.queryList=function(){var e={school_code:o.school_code,school_name:o.school_name,pageNo:o.pagination.currentPage,pageSize:o.pagination.pageSize};l.getAll(e,"school/showSchool").then(function(e){o.pagination.totalCount=e.totalCount,o.pagination.totalPage=e.totalPage,o.pagination.pageSize=e.pageSize,o.pagination.currentPage=e.pageNo,o.root.data=e.data},function(){})},o.queryList(),o.reset=function(){o.school_code="",o.school_name="",o.queryList()},o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root.data,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root.data,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root.data,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.data.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.delRow=function(e){var t={id:e};c.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRow(t,"school/delSchool").then(function(e){1==e?(o.reset(),c.swal("操作成功","","success")):c.swal("操作失败","","error")},function(){c.swal("操作失败","","error")})})},o.delRows=function(){if(o.checked.length<0||0===o.checked.length)c.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:o.checked};c.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRows(t,"school/delSchools").then(function(e){e?(o.reset(),o.select_all=!1,c.swal("操作成功","","success")):c.swal("操作失败","","error")})})}},o.addSchool=function(){r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"schoolForm.html",controller:"addschoolModalCtrl"}).result.then(function(e){},function(e){o.reset()})}}]),app.controller("indexController",["$scope","$rootScope","$http","httpService","localStorageService","$interval","SweetAlert","$window","baseService",function(t,e,o,a,n,r,l,c,i){e.user=n.get("userInfo");var s=r(function(){o.get("/web-logistics/user/loginCheck",{params:{account:e.user.user_name}}).success(function(e){1===e&&(r.cancel(s),l.swal({title:"下线通知",text:"您的账号已在其它地方登录，返回登录页",type:"error"},function(){t.exit()}))})},3e3);t.exit=function(){n.clearAll(),l.swal("退出成功","","success"),c.location.href="/web-logistics"}}]),app.controller("electiveManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope",function(n,t,e,o,a,r,l,c,i,s,u){u.user=s.get("userInfo"),n.marks=[{id:1,name:"课程名称"},{id:2,name:"课程编号"},{id:3,name:"课程负责人"}],n.mark=1,n.root=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.queryList=function(){var e={user_id:u.user.id,pageNo:n.pagination.currentPage,pageSize:n.pagination.pageSize,keyWord:n.keyWord,mark:n.mark};t({method:"POST",url:"../elective/getAllElectiveByUserId",data:e}).success(function(e,t,o,a){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data}).error(function(e,t,o,a){})},n.queryList(),n.reset=function(){n.mark=1,n.keyWord="",n.queryList()},n.delSelectElective=function(o){c.swal({title:"是否确认退选？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){if(e){var t={id:o.id};l.getAll(t,"elective/delSelectElective").then(function(e){1==e?(n.reset(),c.swal("退选成功","","success")):c.swal("选课失败","","error")},function(){c.swal("选课失败","","error")})}})}}]),app.controller("gradeManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope",function(n,a,e,t,o,r,l,c,i,s,u){u.user=s.get("userInfo"),n.marks=[{id:1,name:"课程名称"},{id:2,name:"课程编号"},{id:3,name:"课程负责人"}],n.mark=1,n.college=u.user.college_id,n.colleges=[],n.root=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.queryList=function(){var e={school_id:u.user.school_id};l.getAll(e,"college/getAllCollegeForSelect").then(function(e){n.colleges=e},function(){});var t={college:n.college,school_id:u.user.school_id,pageNo:n.pagination.currentPage,pageSize:n.pagination.pageSize,keyWord:n.keyWord,mark:n.mark};a({method:"POST",url:"../course/getAllCourseBySchoolId",data:t}).success(function(e,t,o,a){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data}).error(function(e,t,o,a){})},n.queryList(),n.elective=function(o){c.swal({title:"是否确认选课？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){if(e){var t={course_id:o.id,user_id:u.user.id};a({method:"POST",url:"../elective/addElectiveForStudent",data:t}).success(function(e,t,o,a){1==e&&c.swal("选课成功","","success"),2==e&&c.swal("已选过该课程","","warning")}).error(function(e,t,o,a){c.swal("选课失败","","error")})}})},n.reset=function(){n.mark=1,n.college=u.user.college_id,n.keyWord="",n.queryList()}}]),app.controller("scheduleQueryManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope",function(n,t,e,o,a,r,l,c,i,s,u){u.user=s.get("userInfo"),n.marks=[{id:1,name:"课程名称"},{id:2,name:"课程编号"},{id:3,name:"课程负责人"}],n.mark=1,n.root=[],n.root1=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.queryList=function(){var e={user_id:u.user.id,college_id:u.user.college_id,school_id:u.user.school_id,pageNo:n.pagination.currentPage,pageSize:n.pagination.pageSize,keyWord:n.keyWord,mark:n.mark};t({method:"POST",url:"../course/getAllCourseForStudent",data:e}).success(function(e,t,o,a){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data[0],n.root1.data=e.data[1]}).error(function(e,t,o,a){})},n.queryList(),n.reset=function(){n.mark=1,n.keyWord="",n.queryList()}}]),app.controller("ClassManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","httpService",function(n,t,e,o,a,r,l,c,i,s,u,l){u.user=s.get("userInfo"),n.root=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.getCourseForClass=function(){var e={user_id:u.user.id};l.getAll(e,"course/getCourseForClass").then(function(e){n.Class=e},function(){})},n.getCourseForClass(),n.queryList=function(){var e={course_id:n.course_id,user_name:n.user_name,pageNo:1,pageSize:10};t({method:"POST",url:"../elective/getAllStudentByCourseId",data:e}).success(function(e,t,o,a){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data}).error(function(e,t,o,a){})},n.queryList(),n.reset=function(){n.user_name="",n.queryList()}}]),app.controller("ClassNameManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","httpService","$interval",function(n,r,e,t,o,a,l,c,i,s,u,l,d){u.user=s.get("userInfo"),n.lateNum="",n.lateValue="",n.sickNum="",n.sickValue="",n.thinkNum="",n.thinkValue="",n.absenteeismNum="",n.absenteeismValue="",n.late="",n.showMark=1,n.getCourseForClass=function(){var e={user_id:u.user.id};l.getAll(e,"course/getCourseForClass").then(function(e){n.Class=e},function(){})},n.getCourseForClass(),n.root=[],n.queryList=function(){var e={course_id:n.course_id};r({method:"POST",url:"../elective/getAllStudentByCourseIdForClass",data:e}).success(function(e,t,o,a){0<e.length&&(n.root=e)}).error(function(e,t,o,a){})},n.queryList();var g=document.getElementById("span");setInterval(function(){n.getTime()},1e3),n.getTime=function(){var e=new Date,t=e.getFullYear(),o=e.getMonth()+1,a=e.getDate(),n=e.getHours(),r=e.getMinutes(),l=e.getSeconds();g.innerHTML=t+"-"+o+"-"+a+" "+n+":"+r+":"+l},n.Naming=function(e,t){var o;if(""==n.absenteeismNum)c.swal("请选择一个考勤参数模版","","warning");else{switch(t){case 1:o=1/n.absenteeismNum*n.absenteeismValue;break;case 2:o=1/n.lateNum*n.lateValue;break;case 3:o=1/n.sickNum*n.sickValue;break;case 4:o=1/n.thinkNum*n.thinkValue;break;default:o=0}var a={elective_id:e.id,mark:t,value:o};r({method:"POST",url:"../elective/updateElectiveByClass",data:a}).success(function(e,t,o,a){1==e?c.swal("点名成功","","success"):c.swal("点名失败","","error")}).error(function(e,t,o,a){c.swal("点名失败","","error")})}},n.getParams=function(){r.get("../params/getAllParams").success(function(e){n.AllParams=e}).error(function(e){})},n.getParams(),n.detailParams=function(){n.showMark=2;var e={params_id:n.params_id};l.getAll(e,"params/getAllParamsById").then(function(e){n.lateNum=e.lateNum,n.lateValue=e.lateValue,n.sickNum=e.sickNum,n.sickValue=e.sickValue,n.thinkNum=e.thinkNum,n.thinkValue=e.thinkValue,n.absenteeismNum=e.absenteeismNum,n.absenteeismValue=e.absenteeismValue,n.late=e.late},function(){})}}]),app.controller("termGradeManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","httpService","$interval",function(c,t,e,o,a,n,r,l,i,s,u,r,d){u.user=s.get("userInfo"),c.root=[],c.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},c.getCourseForClass=function(){var e={user_id:u.user.id};r.getAll(e,"course/getCourseForClass").then(function(e){c.Class=e},function(){})},c.getCourseForClass(),c.queryList=function(){var e={course_id:c.course_id,user_name:c.user_name,pageNo:1,pageSize:10};t({method:"POST",url:"../elective/getAllStudentByCourseId",data:e}).success(function(e,t,o,a){c.pagination.totalCount=e.totalCount,c.pagination.totalPage=e.totalPage,c.pagination.pageSize=e.pageSize,c.pagination.currentPage=e.pageNo,c.root.data=e.data,c.normal_proportion=e.data[0].normal_proportion}).error(function(e,t,o,a){})},c.queryList(),c.reset=function(){c.user_name="",c.queryList()},c.GeneratingFinalResults=function(e,t,o,a){if(null!=c.normal_proportion&&null!=a&&null!=o){var n=c.normal_proportion/100,r=1-n,l=t*n+o*r;e.final_grade=l,e.normal_proportion=c.normal_proportion,e.ordinary_grade=t,e.final_exam_garde=o,e.final_exam_proportion=100*r}},c.save=function(){var e={data:c.root.data};r.postJson(e,"elective/updateFinalGrade").then(function(e){1==e?l.swal("保存成功","","success"):l.swal("保存失败","","error")},function(){l.swal("保存失败","","error")})}}]),app.controller("addSetParamstersModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(t,o,e,a,n,r,l,c,i,s,u){t.title="添加考勤参数模版",t.cancel=function(){l.dismiss("cancel")},t.submitForm=function(){if(t.submit_form.$valid){var e={late_num:t.late_num,late_value:t.late_value,absenteeism_num:t.absenteeism_num,absenteeism_value:t.absenteeism_value,sick_num:t.sick_num,sick_value:t.sick_value,think_num:t.think_num,think_value:t.think_value,late:t.late};o({method:"POST",url:"../params/addSetParams",data:e}).success(function(e,t,o,a){e&&null!=e?i.swal("操作成功","","success"):i.swal("操作失败","","error")}).error(function(e,t,o,a){i.swal("操作失败","","error")})}}}]),app.controller("adduserModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(t,e,o,a,n,r,l,c,i,s,u){t.title="添加用户",t.Marks=[{id:1,name:"学生"},{id:2,name:"教师"}],t.mark=1,t.cancel=function(){l.dismiss("cancel")},t.reader=new FileReader,t.img_upload=function(e){t.reader.readAsDataURL(e[0]),t.reader.onload=function(e){t.$apply(function(){t.path=e.target.result})}},t.submitForm=function(){if(t.submit_form.$valid){var e={username:t.username,mark:t.mark};c.addRow(e,"user/addUser").then(function(e){u.upload({url:"/web-logistics/user/uploadImage",data:{id:e.id},file:t.file}),l.dismiss("ok"),i.swal("操作成功","","success")},function(){})}}}]),app.controller("SetParametersController",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,a,n,r,l,c,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.add=function(){r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"addSetParamstersForm.html",controller:"addSetParamstersModalCtrl"}).result.then(function(e){},function(e){})},o.queryList=function(){e.get("../params/getAllParams").success(function(e){o.pagination.totalCount=e.length,o.pagination.totalPage=e.length/o.pagination.pageSize+1,o.root.data=e,console.log(e)}).error(function(e){})},o.queryList(),o.delRow=function(e){var t={id:e};c.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRow(t,"params/delParams").then(function(e){1==e?(o.queryList(),c.swal("删除成功","","success")):c.swal("删除失败","","error")},function(){c.swal("删除失败","","error")})})}}]),app.controller("UserInfoController",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,a,n,r,l,c,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.queryList=function(){var e={username:o.username,pageNo:o.pagination.currentPage,pageSize:o.pagination.pageSize};l.getAll(e,"user/showUser").then(function(e){o.pagination.totalCount=e.totalCount,o.pagination.totalPage=e.totalPage,o.pagination.pageSize=e.pageSize,o.pagination.currentPage=e.pageNo,o.root.data=e.data},function(){})},o.queryList(),o.reset=function(){o.username="",o.queryList()},o.delRow=function(e){var t={id:e};c.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRow(t,"user/delUser").then(function(e){1==e?(o.reset(),c.swal("操作成功","","success")):c.swal("操作失败","","error")},function(){c.swal("操作失败","","error")})})},o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root.data,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root.data,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root.data,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.data.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.delRows=function(){if(o.checked.length<0||0===o.checked.length)c.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:o.checked};c.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&l.delRows(t,"user/delUsers").then(function(e){e?(o.reset(),o.select_all=!1,c.swal("操作成功","","success")):c.swal("操作失败","","error")})})}}}]);