app.controller("accountManageCtrl",["$scope","localStorageService",function(e,t){console.log(11,t.get("userInfo"))}]),app.controller("addClassRoomModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","$uibModalInstance",function(t,e,o,a,n,r,c,l,i,s,u,d){t.cancel=function(){d.dismiss("cancel")},t.title="添加教室",t.class=s.get("classRoom"),t.submitForm=function(){if(t.submit_form.$valid){var e={class_name:t.className,school_id:t.school};c.addRow(e,"classroom/addClassRoom").then(function(e){e&&null!=e?(d.dismiss("ok"),l.swal("操作成功","","success")):l.swal("操作失败","","error")},function(){l.swal("操作失败","","error")})}}}]),app.controller("ClassRoomController",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope",function(n,o,e,t,a,r,c,l,i,s,u){u.user=s.get("userInfo"),n.school=u.user.school_id,n.schools=[],n.root=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.getAllSchool=function(){o.get("../school/getAllSchoolForSelect").success(function(e,t,o,a){n.schools=e}).error(function(e,t,o,a){})},n.getAllSchool(),n.add=function(){s.set("classRoom",n.schools),r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"classRoomForm.html",controller:"addClassRoomModalCtrl"}).result.then(function(e){},function(e){n.reset()})},n.queryList=function(){var e={school_id:n.school,keyWord:n.keyWord,pageNo:n.pagination.currentPage,pageSize:n.pagination.pageSize};o({method:"POST",url:"../classroom/getAllClassRoom",data:e}).success(function(e,t,o,a){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data}).error(function(e,t,o,a){})},n.queryList(),n.reset=function(){n.keyWord="",n.school=u.user.school_id,n.queryList()},n.delRow=function(e){var t={id:e};l.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&o.get("../classroom/delRow",{params:t}).success(function(e,t,o,a){1==e?(n.reset(),l.swal("删除成功","","success")):l.swal("删除失败","","error")}).error(function(e,t,o,a){l.swal("删除失败","","error")})})},n.editRow=function(e){s.set("classRoom",n.schools),s.set("updateRow",e),r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"classRoomForm.html",controller:"updateClassRoomModalCtrl"}).result.then(function(e){},function(e){n.reset()})}}]),app.controller("updateClassRoomModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","$uibModalInstance",function(t,e,o,a,n,r,c,l,i,s,u,d){t.cancel=function(){d.dismiss("cancel")},t.title="编辑教室",t.class=s.get("classRoom"),t.updateRow=s.get("updateRow"),t.className=t.updateRow.class_name,t.school=t.updateRow.school_id,t.submitForm=function(){if(t.submit_form.$valid){var e={class_name:t.className,school_id:t.school,id:t.updateRow.id};c.addRow(e,"classroom/updateClassRoom").then(function(e){e&&null!=e?(d.dismiss("ok"),l.swal("操作成功","","success")):l.swal("操作失败","","error")},function(){l.swal("操作失败","","error")})}}}]),app.controller("addCourseCtrl",["$scope","$http","httpService","$uibModalInstance","SweetAlert","$rootScope",function(t,e,o,a,n,r){t.cancel=function(){a.dismiss("cancel")},t.title="添加课程信息",t.type=0,t.disabled=!0,t.teacherInfo=[],t.majorInfo=[],t.school_id="",t.teacher_id="",t.element_id="",t.getTeacherAndMajor=function(){o.getAll(null,"course/getAllTeacherAndMajor").then(function(e){t.re=e,t.schoolInfo=e[2]},function(){console.log("获取教师(开课单位)失败")})},t.getTeacherAndMajor(),t.change=function(){t.majorInfo=[],t.teacherInfo=[];try{if(null!=t.school_id)for(var e in t.re[1])t.school_id==t.re[1][e].school_id&&t.majorInfo.push(t.re[1][e])}catch(e){}},t.changeCollege=function(){t.teacherInfo=[];try{if(null!=t.element_id)for(var e in t.re[0])t.element_id==t.re[0][e].college_id&&t.teacherInfo.push(t.re[0][e])}catch(e){}},t.submitForm=function(){if(t.submit_form.$valid){var e={code:t.code,name:t.name,class_hour:t.class_hour,major_id:t.element_id,school_id:t.school_id};console.log("op",e),o.addRow(e,"course/addCourse").then(function(e){t.result=e,t.cancel(),n.swal("操作成功","","success")},function(){n.swal("操作失败","","error")})}else n.swal("操作失败","","error")}}]),app.controller("courseManageCtrl",["$http","httpService","$scope","$uibModal","SweetAlert","$rootScope",function(e,o,a,t,n,r){a.root={},a.rowlist=[],a.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},a.changePageSize=function(e){a.pagination.pageSize=e,a.pagination.currentPage=1,a.queryList()},a.queryList=function(){var e={code:a.code,name:a.name,pageNo:a.pagination.currentPage,pageSize:a.pagination.pageSize};o.getAll(e,"course/showCourse").then(function(e){a.pagination.totalCount=e.totalCount,a.pagination.totalPage=e.totalPage,a.pagination.pageSize=e.pageSize,a.pagination.currentPage=e.pageNo,a.root.data=e.data},function(){})},a.queryList(),a.addCourse=function(){t.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"courseForm.html",controller:"addCourseCtrl"}).result.then(function(e){},function(e){a.queryList()})},a.editRow=function(e){t.open({size:"lg",backdrop:"static",keyboard:!1,animation:!0,templateUrl:"courseForm.html",controller:"updateCourseCtrl",resolve:{data:a.root.data[e]}}).result.then(function(e){},function(e){a.queryList()})},a.reset=function(){a.name=null,a.code=null,a.queryList()},a.delRow=function(e){var t={id:e};n.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&o.delRow(t,"course/delCourse").then(function(e){a.result=e,a.queryList(),1==e?n.swal("删除成功","","success"):n.swal("删除失败","","error")},function(){n.swal("删除失败","","error")})})},a.checked=[],a.selectAll=function(){a.select_all?(a.checked=[],angular.forEach(a.root.data,function(e){e.checked=!0,a.checked.push(e.id)})):angular.forEach(a.root.data,function(e){e.checked=!1,a.checked=[]})},a.selectOne=function(){angular.forEach(a.root.data,function(e){var t=a.checked.indexOf(e.id);e.checked&&-1===t?a.checked.push(e.id):e.checked||-1===t||a.checked.splice(t,1)}),a.root.data.length===a.checked.length?a.select_all=!0:a.select_all=!1},a.delRows=function(){if(a.checked.length<0||0===a.checked.length)n.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:a.checked};n.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&o.delRows(t,"course/delCourses").then(function(e){a.result=e,a.queryList(),1==e?n.swal("删除成功","","success"):n.swal("删除失败","","error")},function(){n.swal("删除失败","","error")})})}}}]),app.controller("updateCourseCtrl",["$scope","data","$uibModalInstance","SweetAlert","httpService",function(o,t,e,a,n){console.log("da",t),o.title="编辑课程信息",o.code=t.code?t.code:"",o.name=t.name?t.name:"",o.class_hour=t.class_hour?t.class_hour:"",o.school_id=t.school_id?t.school_id:"",o.element_id=t.college_id?t.college_id:"",o.cancel=function(){e.dismiss("cancel")};try{o.school_id=t.school_id?t.school_id:"",o.element_id=t.college_id?t.college_id:""}catch(e){}o.getTeacherAndMajor=function(){o.majorInfo=[],o.teacherInfo=[],n.getAll(null,"course/getAllTeacherAndMajor").then(function(e){if(o.re=e,o.schoolInfo=e[2],null!=o.school_id)for(var t in o.re[1])o.school_id==o.re[1][t].school_id&&o.majorInfo.push(o.re[1][t]);if(null!=o.element_id)for(var t in o.re[0])o.element_id==o.re[0][t].college_id&&o.teacherInfo.push(o.re[0][t])},function(){})},o.getTeacherAndMajor(),o.change=function(){o.majorInfo=[],o.teacherInfo=[];try{if(null!=o.school_id)for(var e in o.re[1])o.school_id==o.re[1][e].school_id&&o.majorInfo.push(o.re[1][e])}catch(e){console.log("e",e)}},o.changeCollege=function(){o.teacherInfo=[];try{if(null!=o.element_id)for(var e in o.re[0])o.element_id==o.re[0][e].college_id&&o.teacherInfo.push(o.re[0][e]);console.log(1,o.teacherInfo)}catch(e){console.log("e",e)}},o.submitForm=function(){if(o.submit_form.$valid){var e={id:t.id,code:o.code,name:o.name,class_hour:o.class_hour,major_id:o.element_id,school_id:o.school_id};n.updateRow(e,"course/updateCourse").then(function(e){o.result=e,o.cancel(),1==e?a.swal("修改成功","","success"):a.swal("修改失败","","error")},function(){a.swal("修改失败","","error")})}else a.swal("修改失败","","error")}}]),app.controller("dataManageCtrl",["$scope","SweetAlert","httpService",function(a,n,r){a.addRole=function(){n.swal({title:"添加角色",text:"角色名：",type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"请输入角色名",inputValue:""},function(e){if(console.log(1111,e),!1===e)return!1;if(""===e)return swal.showInputError("请输入角色名"),!1;var t={roleName:e,flag:0};r.addRow(t,"role/addRole").then(function(e){swal("添加成功","success"),a.queryList()},function(){swal("添加失败","error")})})},a.queryList=function(){r.getAll(null,"role/getAll").then(function(e){console.log(e),a.role=e},function(){swal("查询失败","error")})},a.queryList(),a.editRow=function(o){n.swal({title:"编辑角色",text:"角色名：",type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"请输入角色名",inputValue:o.name},function(e){if(console.log(1111,e),!1===e)return!1;if(""===e)return swal.showInputError("请输入角色名"),!1;var t={roleName:e,id:o.id,flag:0};console.log(11,t),r.addRow(t,"role/addRole").then(function(e){swal("修改成功","success"),a.queryList()},function(){swal("修改失败","error")})})},a.delRow=function(e){var t={id:e,flag:1};n.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&r.delRow(t,"role/addRole").then(function(e){a.result=e,a.queryList(),1==e?n.swal("删除成功","","success"):n.swal("删除失败","","error")},function(){n.swal("删除失败","","error")})})}}]),app.controller("indexController",["$scope","$rootScope","$http","httpService","localStorageService","$interval","SweetAlert","$window","baseService",function(o,e,t,a,n,r,c,l,i){o.userInfo=n.get("userInfo");var s={roleId:o.userInfo.mark},u=[];a.getOneRow(s,"role/getOneRole").then(function(e){o.roleName=e.name,u=e.powerId.split("/");for(var t=0;t<u.length;t++)"用户管理"==u[t]&&(o.managerUserInfo=!0),"学校管理"==u[t]&&(o.school=!0),"学院管理"==u[t]&&(o.college=!0),"课程管理"==u[t]&&(o.course=!0),"课程信息"==u[t]&&(o.grade=!0),"课表查询"==u[t]&&(o.schedule=!0),"班级管理"==u[t]&&(o.manageClass=!0),"授课安排"==u[t]&&(o.teach=!0),"学生管理"==u[t]&&(o.student=!0),"课堂点名"==u[t]&&(o.ClassName=!0),"期末成绩"==u[t]&&(o.termGrade=!0),"考勤参数"==u[t]&&(o.SetParameters=!0),"教室管理"==u[t]&&(o.ClassRoom=!0),"角色权限管理"==u[t]&&(o.powerManage=!0),"数据字典"==u[t]&&(o.dataManage=!0),"菜单管理"==u[t]&&(o.menuManage=!0)},function(){})}]),app.controller("addMenuCtrl",["$scope","node","$uibModalInstance","httpService","SweetAlert","localStorageService",function(a,n,e,o,r,t){a.title="添加菜单",a.cancel=function(){e.dismiss("cancel")},a.parentCode=n.code,a.code=1,angular.forEach(t.get("data"),function(e,t,o){e.parent_code==n.code&&a.code++}),a.submitForm=function(){var e={code:n.code+a.code};o.addRow(e,"menu/codeUnique").then(function(e){if(1==e)r.swal("已存在该编码");else{var t={parentCode:n.code,code:n.code+a.code,name:a.name,flag:0};o.addRow(t,"menu/addMenu").then(function(e){1==e?r.swal("添加成功","","success"):r.swal("添加失败","","error")},function(e){r.swal("添加失败","","error")}),a.cancel()}},function(){})}}]),app.controller("menuManageCtrl",["$scope","httpService","SweetAlert","$uibModal","localStorageService",function(a,n,r,t,o){a.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},a.treeData=[],a.changePageSize=function(e){a.pagination.pageSize=e,a.pagination.currentPage=1,a.queryList()},a.getTree=function(){n.getAll(null,"menu/getAllTree").then(function(e){a.treeData=e},function(){r.swal("查询失败","error")})},a.getTree(),a.queryList=function(){var e={name:a.name,code:a.code,pageNo:a.pagination.currentPage,pageSize:a.pagination.pageSize};n.getAll(e,"menu/getAll").then(function(e){console.log(11,e),a.root=e[1],a.pagination.totalCount=e[1].totalCount,a.pagination.totalPage=e[1].totalPage,a.pagination.pageSize=e[1].pageSize,a.pagination.currentPage=e[1].pageNo,o.set("data",e[0])},function(){r.swal("查询失败","","error")})},a.queryList(),a.reset=function(){a.name="",a.code="",a.queryList()};var c=null;a.itemClicked=function(e){var t={code:(c=e).code,pageNo:a.pagination.currentPage,pageSize:a.pagination.pageSize};console.log(1212,t),n.getAll(t,"menu/isDelete").then(function(e){a.root=e},function(){r.swal("查询失败","","error")})},a.addRow=function(){null==c?r.swal("请选择一个节点进行添加"):t.open({size:"medium",backdrop:"static",keyboard:!1,animation:!0,templateUrl:"menuForm.html",controller:"addMenuCtrl",resolve:{node:c}}).result.then(function(e){},function(e){a.queryList(),a.getTree()})},a.delRow=function(e){var t={id:e.id,flag:1},o={code:e.code,pageNo:a.pagination.currentPage,pageSize:a.pagination.pageSize};n.getAll(o,"menu/isDelete").then(function(e){1<e.data.length?r.swal("存在子节点，请先删除子节点"):r.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&n.delRow(t,"menu/addMenu").then(function(e){1==e?r.swal("删除成功","","success"):r.swal("删除失败","","error"),a.queryList(),a.getTree()},function(){r.swal("删除失败","","error")})})},function(){})},a.editRow=function(e){console.log(1,e),t.open({size:"medium",backdrop:"static",keyboard:!1,animation:!0,templateUrl:"menuForm.html",controller:"updateMenuCtrl",resolve:{data:e}}).result.then(function(e){},function(e){a.queryList()})}}]),app.controller("updateMenuCtrl",["$scope","data","httpService","SweetAlert","$uibModalInstance",function(t,o,a,n,e){t.title="修改菜单",t.cancel=function(){e.dismiss("cancel")},t.parentCode=o.parent_code,t.code=parseInt(o.code.substring(o.parent_code.length)),t.name=o.name,t.submitForm=function(){var e={code:t.parentCode+t.code,name:t.name,id:o.id,flag:0};a.addRow(e,"menu/addMenu").then(function(e){1==e?n.swal("修改成功","","success"):n.swal("修改失败","","error")},function(){n.swal("修改成功","","success")}),t.cancel()}}]),app.controller("addPowerCtrl",["$scope","httpService","$uibModalInstance","localStorageService","SweetAlert",function(n,t,e,o,a){n.title="添加角色权限信息",n.cancel=function(){e.dismiss("cancel")},n.disabled=!0,n.getTree=function(){t.getAll(null,"menu/getAllTree").then(function(e){n.treeData=e},function(){a.swal("查询失败","error")})},n.getTree(),n.checkedMenu=[],n.checkedMenuCode=[],n.itemCheckedChanged=function(e){if("0"!==e.code){var t=n.checkedMenuCode.indexOf(e.code);e.checked?-1===t&&(n.checkedMenuCode.push(e.code),n.checkedMenu.push(e.name),console.log(2,n.checkedMenu)):-1!==t&&(n.checkedMenuCode.splice(t,1),n.checkedMenu.splice(t,1),console.log(222,n.checkedMenu))}n.linkageCheckbox(e.childItems,e.checked)},n.linkageCheckbox=function(e,t){if(null!=e&&null!=e)for(var o=0;o<e.length;o++){var a=n.checkedMenuCode.indexOf(e[o].code);t?-1===a&&(n.checkedMenuCode.push(e[o].code),n.checkedMenu.push(e[o].name),console.log("选中",n.checkedMenu)):-1!==a&&(n.checkedMenuCode.splice(a,1),n.checkedMenu.splice(a,1),console.log("取消",n.checkedMenu)),n.linkageCheckbox(e[o].childItems,t)}n.selectAll()},n.selectAll=function(){n.MenuName="",n.MenuId="",n.menu="";for(var e=0;e<n.checkedMenu.length;e++)"0"!=n.checkedMenu[e].parent_code&&(e==n.checkedMenu.length-1?n.MenuName=n.MenuName+n.checkedMenu[e]:n.MenuName=n.MenuName+n.checkedMenu[e]+"/")},n.submitForm=function(){var e={roleName:n.name,remarks:n.remarks,menu:n.MenuName,flag:0};t.addRow(e,"role/addRole").then(function(e){swal("添加成功","","success"),n.cancel()},function(){swal("添加失败","","error")})}}]),app.controller("powerManageCtrl",["$uibModal","$scope","httpService","SweetAlert",function(t,o,a,n){o.addPower=function(){t.open({size:"medium",backdrop:"static",keyboard:!1,animation:!0,templateUrl:"powerForm.html",controller:"addPowerCtrl"}).result.then(function(e){},function(e){o.roleQueryList()})},o.roleQueryList=function(){a.getAll(null,"role/getAll").then(function(e){console.log(e),o.role=e},function(){swal("查询失败","error")})},o.roleQueryList(),o.delRow=function(e){var t={id:e,flag:1};n.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&a.delRow(t,"role/addRole").then(function(e){o.result=e,o.roleQueryList(),1==e?n.swal("删除成功","","success"):n.swal("删除失败","","error")},function(){n.swal("删除失败","","error")})})},o.editRow=function(e){t.open({size:"lg",backdrop:"static",keyboard:!1,animation:!0,templateUrl:"powerForm.html",controller:"updatePowerCtrl",resolve:{data:e}}).result.then(function(e){},function(e){o.roleQueryList()})}}]),app.controller("updatePowerCtrl",["$scope","data","$uibModalInstance","httpService",function(n,t,e,o){console.log("sa1",t),n.cancel=function(){e.dismiss("cancel")},n.title="角色权限信息",n.name=null==t.name?"":t.name,n.remarks=null==t.remarks?"":t.remarks,n.MenuName=null==t.powerId?"":t.powerId,n.getTree=function(){var e={menu:n.MenuName};o.getAll(e,"menu/getAllTree").then(function(e){console.log(1,e),n.treeData=e},function(){SweetAlert.swal("查询失败","error")})},n.getTree(),n.checkedMenu=[],n.checkedMenu=t.powerId.split("/"),n.checkedMenuCode=[],n.itemCheckedChanged=function(e){if("0"!==e.code){var t=n.checkedMenu.indexOf(e.name);1==e.checked?-1===t&&(n.checkedMenuCode.push(e.code),n.checkedMenu.push(e.name),console.log("menu1",n.checkedMenu)):-1!==t&&(n.checkedMenuCode.splice(t,1),n.checkedMenu.splice(t,1),console.log("menu2",n.checkedMenu))}n.linkageCheckbox(e.childItems,e.checked)},n.linkageCheckbox=function(e,t){if(null!=e&&null!=e)for(var o=0;o<e.length;o++){var a=n.checkedMenuCode.indexOf(e[o].code);t?-1===a&&(n.checkedMenuCode.push(e[o].code),n.checkedMenu.push(e[o].name)):-1!==a&&(n.checkedMenuCode.splice(a,1),n.checkedMenu.splice(a,1)),n.linkageCheckbox(e[o].childItems,t)}n.selectAll()},n.selectAll=function(){n.MenuName="",n.MenuId="",n.menu="";for(var e=0;e<n.checkedMenu.length;e++)"0"!=n.checkedMenu[e].parent_code&&(e==n.checkedMenu.length-1?n.MenuName=n.MenuName+n.checkedMenu[e]:n.MenuName=n.MenuName+n.checkedMenu[e]+"/")},n.submitForm=function(){var e={roleName:n.name,remarks:n.remarks,menu:n.MenuName,flag:0,id:t.id};o.addRow(e,"role/addRole").then(function(e){swal("修改成功","","success"),n.cancel()},function(){swal("修改失败","","error")})}}]),app.controller("addcollegeModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(n,e,t,o,a,r,c,l,i,s,u){n.title="添加学院",n.cancel=function(){c.dismiss("cancel")},n.schools=[],n.college_code="",n.college_name="",n.college_detail="",n.submitForm=function(){if(n.submit_form.$valid){var e={college_code:n.college_code,college_name:n.college_name,college_detail:n.college_detail,school_id:n.school_id};l.addRow(e,"college/addCollege").then(function(e){e&&null!=e?(c.dismiss("ok"),i.swal("操作成功","","success")):i.swal("操作失败","","error")},function(){i.swal("操作失败","","error")})}},n.getAllSchool=function(){e.get("../school/getAllSchoolForSelect").success(function(e,t,o,a){n.schools=e}).error(function(e,t,o,a){})},n.getAllSchool()}]),app.controller("addmajorModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(t,e,o,a,n,r,c,l,i,s,u){t.title="添加专业",t.cancel=function(){c.dismiss("cancel")},t.major_code="",t.major_name="",t.major_detail="",t.submitForm=function(){if(t.submit_form.$valid){var e={major_code:t.major_code,major_name:t.major_name,major_detail:t.major_detail};l.addRow(e,"major/addMajor").then(function(e){e&&null!=e?(c.dismiss("ok"),i.swal("操作成功","","success")):i.swal("操作成功","","error")},function(){i.swal("操作成功","","error")})}}}]),app.controller("addschoolModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(t,e,o,a,n,r,c,l,i,s,u){t.title="添加学校",t.cancel=function(){c.dismiss("cancel")},t.submitForm=function(){if(t.submit_form.$valid){var e={school_code:t.school_code,school_name:t.school_name,school_detail:t.school_detail};l.addRow(e,"school/addSchool").then(function(e){e&&null!=e?(c.dismiss("ok"),i.swal("操作成功","","success")):i.swal("操作成功","","error")},function(){i.swal("操作成功","","error")})}}}]),app.controller("collegeManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,a,n,r,c,l,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.queryList=function(){var e={college_code:o.college_code,college_name:o.college_name,pageNo:o.pagination.currentPage,pageSize:o.pagination.pageSize};c.getAll(e,"college/showCollege").then(function(e){o.pagination.totalCount=e.totalCount,o.pagination.totalPage=e.totalPage,o.pagination.pageSize=e.pageSize,o.pagination.currentPage=e.pageNo,o.root.data=e.data},function(){l.swal("操作失败","","error")})},o.queryList(),o.reset=function(){o.college_code="",o.college_name="",o.queryList()},o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root.data,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root.data,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root.data,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.data.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.delRow=function(e){var t={id:e};l.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&c.delRow(t,"college/delCollege").then(function(e){1==e?(o.reset(),l.swal("操作成功","","success")):l.swal("操作失败","","error")},function(){l.swal("操作失败","","error")})})},o.delRows=function(){if(o.checked.length<0||0===o.checked.length)l.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:o.checked};l.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&c.delRows(t,"college/delColleges").then(function(e){e?(o.reset(),o.select_all=!1,l.swal("操作成功","","success")):l.swal("操作失败","","error")})})}},o.addCollege=function(){r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"collegeForm.html",controller:"addcollegeModalCtrl"}).result.then(function(e){},function(e){o.reset()})}}]),app.controller("majorManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,a,n,r,c,l,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.queryList=function(){var e={major_code:o.major_code,major_name:o.major_name,pageNo:o.pagination.currentPage,pageSize:o.pagination.pageSize};c.getAll(e,"major/showMajor").then(function(e){o.pagination.totalCount=e.totalCount,o.pagination.totalPage=e.totalPage,o.pagination.pageSize=e.pageSize,o.pagination.currentPage=e.pageNo,o.root.data=e.data},function(){l.swal("操作失败","","error")})},o.queryList(),o.reset=function(){o.major_code="",o.major_name="",o.queryList()},o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root.data,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root.data,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root.data,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.data.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.delRow=function(e){var t={id:e};l.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&c.delRow(t,"major/delMajor").then(function(e){1==e?(o.reset(),l.swal("操作成功","","success")):l.swal("操作失败","","error")},function(){l.swal("操作失败","","error")})})},o.delRows=function(){if(o.checked.length<0||0===o.checked.length)l.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:o.checked};l.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&c.delRows(t,"major/delMajors").then(function(e){e?(o.reset(),o.select_all=!1,l.swal("操作成功","","success")):l.swal("操作失败","","error")})})}},o.addMajor=function(){r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"majorForm.html",controller:"addmajorModalCtrl"}).result.then(function(e){},function(e){o.reset()})}}]),app.controller("schoolManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,a,n,r,c,l,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.queryList=function(){var e={school_code:o.school_code,school_name:o.school_name,pageNo:o.pagination.currentPage,pageSize:o.pagination.pageSize};c.getAll(e,"school/showSchool").then(function(e){o.pagination.totalCount=e.totalCount,o.pagination.totalPage=e.totalPage,o.pagination.pageSize=e.pageSize,o.pagination.currentPage=e.pageNo,o.root.data=e.data},function(){})},o.queryList(),o.reset=function(){o.school_code="",o.school_name="",o.queryList()},o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root.data,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root.data,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root.data,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.data.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.delRow=function(e){var t={id:e};l.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&c.delRow(t,"school/delSchool").then(function(e){1==e?(o.reset(),l.swal("操作成功","","success")):l.swal("操作失败","","error")},function(){l.swal("操作失败","","error")})})},o.delRows=function(){if(o.checked.length<0||0===o.checked.length)l.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:o.checked};l.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&c.delRows(t,"school/delSchools").then(function(e){e?(o.reset(),o.select_all=!1,l.swal("操作成功","","success")):l.swal("操作失败","","error")})})}},o.addSchool=function(){r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"schoolForm.html",controller:"addschoolModalCtrl"}).result.then(function(e){},function(e){o.reset()})}}]),app.controller("electiveManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope",function(n,t,e,o,a,r,c,l,i,s,u){u.user=s.get("userInfo"),n.marks=[{id:1,name:"课程名称"},{id:2,name:"课程编号"},{id:3,name:"课程负责人"}],n.mark=1,n.root=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.queryList=function(){var e={user_id:u.user.id,pageNo:n.pagination.currentPage,pageSize:n.pagination.pageSize,keyWord:n.keyWord,mark:n.mark};t({method:"POST",url:"../elective/getAllElectiveByUserId",data:e}).success(function(e,t,o,a){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data}).error(function(e,t,o,a){})},n.queryList(),n.reset=function(){n.mark=1,n.keyWord="",n.queryList()},n.delSelectElective=function(o){l.swal({title:"是否确认退选？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){if(e){var t={id:o.id};c.getAll(t,"elective/delSelectElective").then(function(e){1==e?(n.reset(),l.swal("退选成功","","success")):l.swal("选课失败","","error")},function(){l.swal("选课失败","","error")})}})}}]),app.controller("gradeManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope",function(n,a,e,t,o,r,c,l,i,s,u){u.user=s.get("userInfo"),n.marks=[{id:1,name:"课程名称"},{id:2,name:"课程编号"},{id:3,name:"课程负责人"}],n.mark=1,n.college=u.user.college_id,n.colleges=[],n.root=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.queryList=function(){var e={school_id:u.user.school_id};c.getAll(e,"college/getAllCollegeForSelect").then(function(e){n.colleges=e},function(){});var t={college:n.college,school_id:u.user.school_id,pageNo:n.pagination.currentPage,pageSize:n.pagination.pageSize,keyWord:n.keyWord,mark:n.mark};a({method:"POST",url:"../course/getAllCourseBySchoolId",data:t}).success(function(e,t,o,a){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data}).error(function(e,t,o,a){})},n.queryList(),n.elective=function(o){l.swal({title:"是否确认选课？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){if(e){var t={course_id:o.id,user_id:u.user.id};a({method:"POST",url:"../elective/addElectiveForStudent",data:t}).success(function(e,t,o,a){1==e&&l.swal("选课成功","","success"),2==e&&l.swal("已选过该课程","","warning")}).error(function(e,t,o,a){l.swal("选课失败","","error")})}})},n.reset=function(){n.mark=1,n.college=u.user.college_id,n.keyWord="",n.queryList()}}]),app.controller("scheduleQueryManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope",function(n,t,e,o,a,r,c,l,i,s,u){u.user=s.get("userInfo"),n.marks=[{id:1,name:"课程名称"},{id:2,name:"课程编号"},{id:3,name:"课程负责人"}],n.mark=1,n.root=[],n.root1=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.queryList=function(){var e={user_id:u.user.id,college_id:u.user.college_id,school_id:u.user.school_id,pageNo:n.pagination.currentPage,pageSize:n.pagination.pageSize,keyWord:n.keyWord,mark:n.mark};t({method:"POST",url:"../course/getAllCourseForStudent",data:e}).success(function(e,t,o,a){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data[0],n.root1.data=e.data[1]}).error(function(e,t,o,a){})},n.queryList(),n.reset=function(){n.mark=1,n.keyWord="",n.queryList()}}]),app.controller("studentManageCtrl",["$scope",function(e){}]),app.controller("ClassManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","httpService",function(n,t,e,o,a,r,c,l,i,s,u,c){u.user=s.get("userInfo"),n.root=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.getCourseForClass=function(){var e={user_id:u.user.id};c.getAll(e,"arrange/getCourseForClass").then(function(e){console.log(111,e),n.Class=e},function(){})},n.getCourseForClass(),n.queryList=function(){var e={course_id:n.course_id,user_name:n.user_name,teacher_id:n.user.id,pageNo:1,pageSize:10};t({method:"POST",url:"../studentCourse/getAllStudentByCourseId",data:e}).success(function(e,t,o,a){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data}).error(function(e,t,o,a){})},n.queryList(),n.reset=function(){n.user_name="",n.queryList()}}]),app.controller("ClassNameManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","httpService","$interval",function(n,r,e,t,o,a,c,l,i,s,u,c,d){u.user=s.get("userInfo"),n.lateNum="",n.lateValue="",n.sickNum="",n.sickValue="",n.thinkNum="",n.thinkValue="",n.absenteeismNum="",n.absenteeismValue="",n.late="",n.showMark=1,n.getCourseForClass=function(){var e={user_id:u.user.id};c.getAll(e,"arrange/getCourseForClass").then(function(e){n.Class=e},function(){})},n.getCourseForClass(),n.root=[],n.queryList=function(){var e={course_id:n.course_id,teacher_id:u.user.id};r({method:"POST",url:"../studentCourse/getAllStudentByCourseIdForClass",data:e}).success(function(e,t,o,a){0<e.length&&(n.root=e)}).error(function(e,t,o,a){})},n.queryList();var g=document.getElementById("span");setInterval(function(){n.getTime()},1e3),n.getTime=function(){var e=new Date,t=e.getFullYear(),o=e.getMonth()+1,a=e.getDate(),n=e.getHours(),r=e.getMinutes(),c=e.getSeconds();g.innerHTML=t+"-"+o+"-"+a+" "+n+":"+r+":"+c},n.Naming=function(e,t){var o;if(""==n.absenteeismNum)l.swal("请选择一个考勤参数模版","","warning");else{switch(t){case 1:o=1/n.absenteeismNum*n.absenteeismValue;break;case 2:o=1/n.lateNum*n.lateValue;break;case 3:o=1/n.sickNum*n.sickValue;break;case 4:o=1/n.thinkNum*n.thinkValue;break;default:o=0}var a={elective_id:e.id,mark:t,value:o};r({method:"POST",url:"../studentCourse/updateElectiveByClass",data:a}).success(function(e,t,o,a){1==e?l.swal("点名成功","","success"):l.swal("点名失败","","error")}).error(function(e,t,o,a){l.swal("点名失败","","error")})}},n.getParams=function(){r.get("../params/getAllParams").success(function(e){n.AllParams=e}).error(function(e){})},n.getParams(),n.detailParams=function(){n.showMark=2;var e={params_id:n.params_id};c.getAll(e,"params/getAllParamsById").then(function(e){n.lateNum=e.lateNum,n.lateValue=e.lateValue,n.sickNum=e.sickNum,n.sickValue=e.sickValue,n.thinkNum=e.thinkNum,n.thinkValue=e.thinkValue,n.absenteeismNum=e.absenteeismNum,n.absenteeismValue=e.absenteeismValue,n.late=e.late},function(){})}}]),app.controller("importStudentCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","$uibModalInstance",function(o,e,t,a,n,r,c,l,i,s,u,d){o.user=s.get("userInfo"),o.importStudentRow=s.get("importStudentRow"),console.log(141,o.importStudentRow),o.cancel=function(){d.dismiss("cancel")},o.title="添加学生",o.root=[],o.queryList=function(){var e={school_id:o.user.school_id};c.getAll(e,"user/getAllUerForImport").then(function(e){o.root=e},function(){})},o.queryList(),o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.submitForm=function(){if(o.submit_form.$valid){var e={teacher_id:o.user.id,course_id:o.importStudentRow.id,user_id:o.checked};c.postJson(e,"studentCourse/addStudentCourse").then(function(e){1==e?(d.dismiss("ok"),l.swal("添加成功","","success")):(d.dismiss("ok"),l.swal("添加失败","","error"))},function(){d.dismiss("ok"),l.swal("添加失败","","error")})}}}]),app.controller("teachingArrangementsCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope",function(n,a,e,t,o,r,c,l,i,s,u){u.user=s.get("userInfo"),n.marks=[{id:1,name:"课程名称"},{id:2,name:"课程编号"}],n.mark=1,n.college=u.user.college_id,n.colleges=[],n.root=[],n.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},n.queryList=function(){var e={school_id:u.user.school_id};c.getAll(e,"college/getAllCollegeForSelect").then(function(e){n.colleges=e},function(){});var t={college:n.college,school_id:u.user.school_id,pageNo:n.pagination.currentPage,pageSize:n.pagination.pageSize,keyWord:n.keyWord,mark:n.mark};a({method:"POST",url:"../course/getAllCourseBySchoolId",data:t}).success(function(e,t,o,a){n.pagination.totalCount=e.totalCount,n.pagination.totalPage=e.totalPage,n.pagination.pageSize=e.pageSize,n.pagination.currentPage=e.pageNo,n.root.data=e.data}).error(function(e,t,o,a){})},n.queryList(),n.elective=function(o){l.swal({title:"是否确认选课？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){if(e){var t={course_id:o.id,user_id:u.user.id};a({method:"POST",url:"../elective/addElectiveForStudent",data:t}).success(function(e,t,o,a){1==e&&l.swal("选课成功","","success"),2==e&&l.swal("已选过该课程","","warning")}).error(function(e,t,o,a){l.swal("选课失败","","error")})}})},n.Arrangement=function(e){s.set("TRrow",e),r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"teachingArrangeForm.html",controller:"teachingArrangeModalCtrl"}).result.then(function(e){},function(e){n.reset()})},n.reset=function(){n.mark=1,n.college=u.user.college_id,n.keyWord="",n.queryList()},n.viewTeachManage=function(e){s.set("ViewTeachArrange",e),r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"viewTeachArrangeForm.html",controller:"ViewTeachArrangeModalCtrl"}).result.then(function(e){},function(e){n.reset()})},n.addCourse=function(){r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"courseForm.html",controller:"addCourseCtrl"}).result.then(function(e){},function(e){n.queryList()})},n.importStudent=function(e){s.set("importStudentRow",e),r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"importStudentForm.html",controller:"importStudentCtrl"}).result.then(function(e){},function(e){n.queryList()})}}]),app.controller("teachingArrangeModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","$uibModalInstance",function(n,o,e,t,a,r,c,l,i,s,u,d){n.user=s.get("userInfo"),n.title="授课安排",n.cancel=function(){d.dismiss("cancel")},n.TRrow=s.get("TRrow"),n.className=n.TRrow.name,n.college=n.TRrow.college_name,n.userName=n.user.userName,n.Weeks=[{id:1,name:"星期一"},{id:2,name:"星期二"},{id:3,name:"星期三"},{id:4,name:"星期四"},{id:5,name:"星期五"},{id:6,name:"星期六"},{id:7,name:"星期日"}],n.ClassRoom=[],n.Classes=[{week:"",class_time_start:"",class_time_end:"",isDel:!1}],n.addClassTime=function(e){n.Classes.splice(e+1,0,{week:"",class_time_start:"",class_time_end:"",isDel:!0})},n.delClassTime=function(e){n.Classes.splice(e,1),n.getAllClassRoom()},n.getAllClassRoom=function(){n.Week="",n.classTimeStart="",n.classTimeEnd="";for(var e=0;e<n.Classes.length;e++)""!=n.Classes[e].week&&null!=n.Classes[e].class_time_start&&null!=n.Classes[e].class_time_end&&null!=n.Classes[e].week&&""!=n.Classes[e].class_time_start&&""!=n.Classes[e].class_time_end&&(n.Week+=n.Classes[e].week+"/",n.classTimeStart+=n.Classes[e].class_time_start+"/",n.classTimeEnd+=n.Classes[e].class_time_end+"/");if(""!=n.Week&&""!=n.classTimeStart&&""!=n.classTimeEnd){var t={school_id:n.TRrow.school_id,week:n.Week,classTimeStart:n.classTimeStart,classTimeEnd:n.classTimeEnd};o({method:"POST",url:"../classroom/getAllClassRoomBSchoolId",data:t}).success(function(e,t,o,a){n.ClassRoom=e}).error(function(e,t,o,a){})}},n.submitForm=function(){n.Week2="",n.classTimeStart2="",n.classTimeEnd2="";for(var e=0;e<n.Classes.length;e++)n.Week2+=n.Classes[e].week+"/",n.classTimeStart2+=n.Classes[e].class_time_start+"/",n.classTimeEnd2+=n.Classes[e].class_time_end+"/";if(n.submit_form.$valid){var t={class_id:n.class_place,course_id:n.TRrow.id,start_week:n.start_time,end_week:n.end_time,week:n.Week2,classTimeStart:n.classTimeStart2,classTimeEnd:n.classTimeEnd2,user_id:n.user.id};o({method:"POST",url:"../arrange/teachingManage",data:t}).success(function(e,t,o,a){1==e&&(d.dismiss("ok"),l.swal("操作成功","","success")),0==e&&(d.dismiss("ok"),l.swal("操作失败","","error"))}).error(function(e,t,o,a){d.dismiss("ok"),l.swal("操作失败","","error")})}}}]),app.controller("termGradeManageCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","httpService","$interval",function(l,t,e,o,a,n,r,c,i,s,u,r,d){u.user=s.get("userInfo"),l.root=[],l.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},l.getCourseForClass=function(){var e={user_id:u.user.id};r.getAll(e,"course/getCourseForClass").then(function(e){l.Class=e},function(){})},l.getCourseForClass(),l.queryList=function(){var e={course_id:l.course_id,user_name:l.user_name,pageNo:1,pageSize:10};t({method:"POST",url:"../elective/getAllStudentByCourseId",data:e}).success(function(e,t,o,a){l.pagination.totalCount=e.totalCount,l.pagination.totalPage=e.totalPage,l.pagination.pageSize=e.pageSize,l.pagination.currentPage=e.pageNo,l.root.data=e.data,l.normal_proportion=e.data[0].normal_proportion}).error(function(e,t,o,a){})},l.queryList(),l.reset=function(){l.user_name="",l.queryList()},l.GeneratingFinalResults=function(e,t,o,a){if(null!=l.normal_proportion&&null!=a&&null!=o){var n=l.normal_proportion/100,r=1-n,c=t*n+o*r;e.final_grade=c,e.normal_proportion=l.normal_proportion,e.ordinary_grade=t,e.final_exam_garde=o,e.final_exam_proportion=100*r}},l.save=function(){var e={data:l.root.data};r.postJson(e,"elective/updateFinalGrade").then(function(e){1==e?c.swal("保存成功","","success"):c.swal("保存失败","","error")},function(){c.swal("保存失败","","error")})}}]),app.controller("ViewTeachArrangeModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService","$rootScope","$uibModalInstance",function(r,t,e,o,a,n,c,l,i,s,u,d){r.user=s.get("userInfo"),r.ViewTeachArrange=s.get("ViewTeachArrange"),r.className=r.ViewTeachArrange.name,r.college=r.ViewTeachArrange.college_name,r.userName=r.user.userName,r.week="",r.classTime="",r.switchTime="",r.class_place="",r.cancel=function(){d.dismiss("cancel")},r.title="查看授课安排",r.queryList=function(){var e={user_id:r.user.id,course_id:r.ViewTeachArrange.id};t({method:"POST",url:"../arrange/getAllArrange",data:e}).success(function(e,t,o,a){r.week=e[0].start_week+"--"+e[0].end_week,r.class_place=e[0].class_name;for(var n=0;n<e.length;n++)r.switchDate(e[n].week),r.classTime+=r.switchTime+e[n].section_number+"节  "}).error(function(e,t,o,a){})},r.queryList(),r.switchDate=function(e){switch(e){case 1:r.switchTime="星期一";break;case 2:r.switchTime="星期二";break;case 3:r.switchTime="星期三";break;case 4:r.switchTime="星期四";break;case 5:r.switchTime="星期五";break;case 6:r.switchTime="星期六";break;case 7:r.switchTime="星期日"}}}]),app.controller("addSetParamstersModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload",function(t,o,e,a,n,r,c,l,i,s,u){t.title="添加考勤参数模版",t.cancel=function(){c.dismiss("cancel")},t.submitForm=function(){if(t.submit_form.$valid){var e={late_num:t.late_num,late_value:t.late_value,absenteeism_num:t.absenteeism_num,absenteeism_value:t.absenteeism_value,sick_num:t.sick_num,sick_value:t.sick_value,think_num:t.think_num,think_value:t.think_value,late:t.late};o({method:"POST",url:"../params/addSetParams",data:e}).success(function(e,t,o,a){e&&null!=e?i.swal("操作成功","","success"):i.swal("操作失败","","error")}).error(function(e,t,o,a){i.swal("操作失败","","error")})}}}]),app.controller("adduserModalCtrl",["$scope","$http","$filter","$state","$stateParams","$uibModal","$uibModalInstance","httpService","SweetAlert","LoadingService","Upload","localStorageService",function(t,e,o,a,n,r,c,l,i,s,u,d){t.title="添加用户",t.mark=1,t.cancel=function(){c.dismiss("cancel")},t.getRole=function(){l.getAll(null,"role/getAll").then(function(e){console.log(123,e),t.role=e},function(){swal("查询失败","error")})},t.getRole(),t.reader=new FileReader,t.img_upload=function(e){t.reader.readAsDataURL(e[0]),t.reader.onload=function(e){t.$apply(function(){t.path=e.target.result})}},t.submitForm=function(){if(t.submit_form.$valid){var e={username:t.username,mark:t.mark,phone:t.phone,code:t.code};l.addRow(e,"user/addUser").then(function(e){u.upload({url:"/web-logistics/user/uploadImage",data:{id:e.id},file:t.file}),c.dismiss("ok"),i.swal("操作成功","","success")},function(){})}}}]),app.controller("SetParametersController",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,a,n,r,c,l,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.add=function(){r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"addSetParamstersForm.html",controller:"addSetParamstersModalCtrl"}).result.then(function(e){},function(e){})},o.queryList=function(){e.get("../params/getAllParams").success(function(e){o.pagination.totalCount=e.length,o.pagination.totalPage=e.length/o.pagination.pageSize+1,o.root.data=e,console.log(e)}).error(function(e){})},o.queryList(),o.delRow=function(e){var t={id:e};l.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&c.delRow(t,"params/delParams").then(function(e){1==e?(o.queryList(),l.swal("删除成功","","success")):l.swal("删除失败","","error")},function(){l.swal("删除失败","","error")})})}}]),app.controller("updateUserInfoCtrl",["$scope","data","$uibModalInstance","httpService","Upload","SweetAlert",function(t,o,a,n,r,c){t.title="修改用户",t.cancel=function(){a.dismiss("cancel")},t.mark=o.mark,t.username=o.user_name,t.phone=o.phone,t.code=o.code,t.path=o.image_url,t.getRole=function(){n.getAll(null,"role/getAll").then(function(e){console.log(123,e),t.role=e},function(){swal("查询失败","error")})},t.getRole(),t.reader=new FileReader,t.img_upload=function(e){t.reader.readAsDataURL(e[0]),t.reader.onload=function(e){t.$apply(function(){t.path=e.target.result})}},t.submitForm=function(){if(t.submit_form.$valid){var e={username:t.username,mark:t.mark,phone:t.phone,code:t.code,id:o.id};n.addRow(e,"user/addUser").then(function(e){r.upload({url:"/web-logistics/user/uploadImage",data:{id:e.id},file:t.file}),a.dismiss("ok"),c.swal("操作成功","","success")},function(){})}}}]),app.controller("UserInfoController",["$scope","$http","$filter","$state","$stateParams","$uibModal","httpService","SweetAlert","LoadingService","localStorageService",function(o,e,t,a,n,r,c,l,i,s){o.root=[],o.pagination={totalCount:0,totalPage:0,pageSize:10,currentPage:1,PageSizeList:[5,10,30]},o.queryList=function(){var e={username:o.username,pageNo:o.pagination.currentPage,pageSize:o.pagination.pageSize};c.getAll(e,"user/showUser").then(function(e){o.pagination.totalCount=e.totalCount,o.pagination.totalPage=e.totalPage,o.pagination.pageSize=e.pageSize,o.pagination.currentPage=e.pageNo,o.root.data=e.data,console.log(11111,e)},function(){})},o.queryList(),o.reset=function(){o.username="",o.queryList()},o.addUserInfo=function(){r.open({backdrop:"static",keyboard:!1,animation:!0,templateUrl:"userForm.html",controller:"adduserModalCtrl"}).result.then(function(e){},function(e){o.reset()})},o.delRow=function(e){var t={id:e};l.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&c.delRow(t,"user/delUser").then(function(e){1==e?(o.reset(),l.swal("操作成功","","success")):l.swal("操作失败","","error")},function(){l.swal("操作失败","","error")})})},o.checked=[],o.selectAll=function(){o.select_all?(o.checked=[],angular.forEach(o.root.data,function(e){e.checked=!0,o.checked.push(e.id)})):angular.forEach(o.root.data,function(e){e.checked=!1,o.checked=[]})},o.selectOne=function(){angular.forEach(o.root.data,function(e){var t=o.checked.indexOf(e.id);e.checked&&-1===t?o.checked.push(e.id):e.checked||-1===t||o.checked.splice(t,1)}),o.root.data.length===o.checked.length?o.select_all=!0:o.select_all=!1},o.delRows=function(){if(o.checked.length<0||0===o.checked.length)l.swal("至少选择一条记录，再做删除","","warning");else{var t={ids:o.checked};l.swal({title:"是否确认删除？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确认",cancelButtonText:"取消",closeOnConfirm:!1},function(e){e&&c.delRows(t,"user/delUsers").then(function(e){e?(o.reset(),o.select_all=!1,l.swal("操作成功","","success")):l.swal("操作失败","","error")})})}},o.editRow=function(e){r.open({size:"lg",backdrop:"static",keyboard:!1,animation:!0,templateUrl:"userForm.html",controller:"updateUserInfoCtrl",resolve:{data:e}}).result.then(function(e){},function(e){o.queryList()})}}]);